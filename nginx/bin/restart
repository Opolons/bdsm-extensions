#!/usr/bin/env bash

source "$extension_scripts_path/initialize"

if [[ ${master_pid:-0} -gt 0 ]] ; then

  $scripts_path/log "info" "Restarting Nginx ($master_pid)"

  kill -USR2 $master_pid

else

  $scripts_path/log "warn" "Nginx is not running\n  (using pidfile: $nginx_pid)\n Starting Nginx.\n"

  nginx -t -c /etc/nginx/nginx.conf &&
    nginx -c /etc/nginx/nginx.conf

fi

exit $?
